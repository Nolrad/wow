<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <title>Loot Tracker — Historique de guilde</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <!-- CSS global -->
  <link rel="stylesheet" href="../assets/css/site.css" />
  <!-- CSS page -->
  <link rel="stylesheet" href="../assets/css/pages/loot_tracker.css" />
</head>

<body>
  <!-- Navbar injectée -->
  <script src="../assets/js/nav.js"></script>

  <header class="page-header">
    <h1>Loot Tracker</h1>
    <p>
      Historique des loots de guilde — Vanilla & TBC<br />
      Source partagée : <code>/json/loot_thunderstrike.json</code>
    </p>
  </header>

  <main class="container">

    <!-- ===================== -->
    <!-- JSON partagé -->
    <!-- ===================== -->
    <section class="card">
      <h2>Données partagées (site)</h2>
      <div class="lt-row lt-row-wrap">
        <button id="btnReloadShared" class="btn btn-secondary" type="button">
          Recharger le JSON partagé
        </button>
        <span id="sharedStatus" class="lt-status" aria-live="polite"></span>
      </div>
      <p class="hint">
        Lecture seule depuis le dépôt GitHub.  
        Pour mettre à jour : remplacer le fichier JSON et commit.
      </p>
    </section>

    <!-- ===================== -->
    <!-- Import local -->
    <!-- ===================== -->
    <section class="card">
      <h2>Import local (optionnel)</h2>

      <div class="lt-grid">
        <div class="lt-block">
          <h3>Importer un fichier JSON</h3>
          <input id="fileInput" class="lt-file" type="file" accept=".json,application/json" />
          <div class="lt-row">
            <button id="btnImportFile" class="btn btn-primary" type="button">
              Importer
            </button>
            <button id="btnClearPaste" class="btn btn-secondary" type="button">
              Vider
            </button>
          </div>
        </div>

        <div class="lt-block">
          <h3>Coller un JSON</h3>
          <textarea
            id="pasteArea"
            class="lt-textarea"
            placeholder="Colle ici un export JSON de l’addon…"></textarea>
          <div class="lt-row">
            <button id="btnImportPaste" class="btn btn-primary" type="button">
              Importer
            </button>
          </div>
        </div>
      </div>

      <div class="lt-row lt-row-wrap">
        <label class="lt-check">
          <input id="chkMerge" type="checkbox" checked />
          Fusionner avec l’existant
        </label>

        <label class="lt-check">
          <input id="chkFilterMinQuality" type="checkbox" checked />
          Respecter la qualité minimale
        </label>
      </div>

      <div id="importStatus" class="lt-status" aria-live="polite"></div>
    </section>

    <!-- ===================== -->
    <!-- Consultation -->
    <!-- ===================== -->
    <section class="card">
      <h2>Historique des loots</h2>

      <div class="lt-row lt-row-wrap">
        <label class="lt-label">
          Vainqueur
          <select id="winnerSelect" class="lt-select"></select>
        </label>


        <label class="lt-label">
          Instance
          <input id="instanceFilter" class="lt-input" type="text" placeholder="Karazhan, SM…" />
        </label>

        <label class="lt-label">
          Item
          <input id="itemFilter" class="lt-input" type="text" placeholder="Épée, Cape…" />
        </label>

        <button id="btnRefresh" class="btn btn-secondary" type="button">
          Rafraîchir
        </button>
      </div>

      <div id="summary" class="lt-summary"></div>

      <div class="lt-tableWrap" role="region">
        <table class="lt-table">
          <thead>
            <tr>
              <th>Date</th>
              <th>Instance</th>
              <th>Boss</th>
              <th>Vainqueur</th>
              <th>Item</th>
              <th>Qualité</th>
              <th>Rand</th>
            </tr>
          </thead>
          <tbody id="lootTbody"></tbody>
        </table>
      </div>
    </section>

    <footer class="footer">
      Loot Tracker — JSON partagé + cache local navigateur
    </footer>

  </main>

  <!-- ===================== -->
  <!-- JS page -->
  <!-- ===================== -->
  <script src="../assets/js/pages/loot_tracker.js"></script>

  <!-- ===================== -->
  <!-- Wowhead tooltips -->
  <!-- ===================== -->
  <script>
    var whTooltips = {
      colorLinks: true,
      iconizeLinks: false,
      renameLinks: false
    };
  </script>
  <script src="https://wowhead.com/classic/widgets/power.js"></script>

</body>
</html>
